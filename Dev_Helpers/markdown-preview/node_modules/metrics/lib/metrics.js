(function() {
  var Reporter, crypto;

  crypto = require('crypto');

  Reporter = require('./reporter');

  module.exports = {
    activate: function(_arg) {
      var sessionLength;
      sessionLength = _arg.sessionLength;
      if (atom.config.get('metrics.userId')) {
        return this.begin(sessionLength);
      } else {
        this.getUserId(function(userId) {
          return atom.config.set('metrics.userId', userId);
        });
        return this.begin(sessionLength);
      }
    },
    serialize: function() {
      return {
        sessionLength: Date.now() - this.sessionStart
      };
    },
    begin: function(sessionLength) {
      this.sessionStart = Date.now();
      if (sessionLength) {
        Reporter.sendEvent('window', 'ended', sessionLength);
      }
      Reporter.sendEvent('window', 'started');
      atom.workspaceView.on('pane:item-added', function(event, item) {
        return Reporter.sendPaneItem(item);
      });
      if (atom.getLoadSettings().shellLoadTime != null) {
        Reporter.sendTiming('shell', 'load', atom.getLoadSettings().shellLoadTime);
      }
      return process.nextTick(function() {
        return Reporter.sendTiming('core', 'load', atom.getWindowLoadTime());
      });
    },
    getUserId: function(callback) {
      return require('getmac').getMac((function(_this) {
        return function(error, macAddress) {
          if (error != null) {
            return callback(require('guid').raw());
          } else {
            return callback(crypto.createHash('sha1').update(macAddress, 'utf8').digest('hex'));
          }
        };
      })(this));
    }
  };

}).call(this);

//# sourceMappingURL=/../../../../../../../../..//tmp/atom-build/Atom.app/Contents/Resources/app/node_modules/metrics/lib/metrics.js.map
